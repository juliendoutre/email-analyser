(this["webpackJsonpemail-analyser"]=this["webpackJsonpemail-analyser"]||[]).push([[0],{282:function(e,t,a){e.exports=a(465)},287:function(e,t,a){},289:function(e,t,a){},465:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(54),c=a.n(l),i=(a(287),a(288),a(289),a(477)),o=a(487),s=a(45),u=a(118),m=function(){return r.a.createElement(o.a,{as:"h1",icon:!0,textAlign:"center"},r.a.createElement(s.a,{name:"mail",circular:!0}),r.a.createElement(o.a.Content,null,"Email Analyser",r.a.createElement(u.a,{color:"blue"},"BETA")),r.a.createElement(o.a.Subheader,null,"Parse an email headers to get more insights into its metadata."))},d=function(){return r.a.createElement("a",{href:"https://github.com/juliendoutre/email-analyser",className:"github-corner","aria-label":"View source on GitHub"},r.a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 250 250",style:{fill:"#151513",color:"#fff",position:"absolute",top:"0",border:"0",right:"0"},"aria-hidden":"true"},r.a.createElement("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),r.a.createElement("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{transformOrigin:"130px 106px"},className:"octo-arm"}),r.a.createElement("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"octo-body"})))},h=a(241),f=a(113),E=a(114),p=a(117),g=a(119),y=a(478),b=a(486),v=a(485),C=a(481),w=a(158),k=a(483),x=function(e,t){return function(){var a=document.createElement("a"),n=new Blob([e],{type:"application/json"});a.href=URL.createObjectURL(n),a.download=t,a.click()}},j=function(e){return r.a.createElement(w.a,{basic:!0},r.a.createElement(b.a,{icon:!0,labelPosition:"right",onClick:(t=e.results,a="email-analyzer-metadata-headers.csv",function(){var e="";Object.keys(t).forEach((function(a){e+=a+',"'+(Array.isArray(t[a])?t[a].join("\n"):t[a])+'"\n'}));var n=document.createElement("a"),r=new Blob([e],{type:"text/csv"});n.href=URL.createObjectURL(r),n.download=a,n.click()})},"Download CSV",r.a.createElement(s.a,{name:"download"})),r.a.createElement(k.a,{selectable:!0,basic:"very"},r.a.createElement(k.a.Body,null,Object.keys(e.results).map((function(t){return r.a.createElement(k.a.Row,{key:t},r.a.createElement(k.a.Cell,null,t),r.a.createElement(k.a.Cell,null,r.a.createElement(w.a,{basic:!0,style:{overflow:"auto",width:"45vw",whiteSpace:"nowrap"}}," ",Array.isArray(e.results[t])?e.results[t].join("\n"):e.results[t])))})))));var t,a},O=a(69),S=function(e,t){null!=e.name&&(e.name in t?Array.isArray(t[e.name])?t[e.name].push(e.contents):t[e.name]=[t[e.name],e.contents]:t[e.name]=e.contents)},A=function(e){var t,a={},n={name:null,contents:null},r=Object(O.a)(e.split("\n"));try{for(r.s();!(t=r.n()).done;){var l=t.value;if(""!==l){var c=l.match(/^[-\w]*:/);null!=c&&c.length>0?(S(n,a),n.name=c[0].replace(":",""),n.contents=l.replace(c[0],"").trim()):(""!==n.contents&&(n.contents+="\n"),n.contents+=l.trim())}}}catch(i){r.e(i)}finally{r.f()}return S(n,a),a},I=function(e){var t=JSON.stringify(e.results,null,2);return r.a.createElement(w.a,{basic:!0},r.a.createElement(b.a,{icon:!0,labelPosition:"right",onClick:x(t,"email-analyzer-metadata-headers.json")},"Download JSON",r.a.createElement(s.a,{name:"download"})),r.a.createElement("pre",{style:{overflowX:"auto"}},t))},T=a(32),R=function(e,t){return Array.isArray(t)&&t.indexOf(e.id)>-1?1===e.level?"blue":"green":1===e.level?"red":"gray"},H=function(e){Object(g.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(f.a)(this,a),(n=t.call(this,e)).state={enabled:"Received"in n.props.results},n}return Object(E.a)(a,[{key:"componentDidMount",value:function(){if(this.state.enabled){var e=function(e){var t,a={nodes:[],links:[]},n=Object(O.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,l=r.match(/by [-.:\w]*/),c=r.match(/^from [-.:\w]*/);null!==l&&l.length>0&&function(){var e=l[0].replace("by ","").toLowerCase();if(a.nodes.reduce((function(t,a){return t||a.id===e}),!1)||a.nodes.push({id:e}),null!=c&&c.length>0){var t=c[0].replace("from ","").toLowerCase();a.links.push({source:t,target:e,strength:.5}),a.nodes.reduce((function(e,a){return e||a.id===t}),!1)||a.nodes.push({id:t})}}()}}catch(i){n.e(i)}finally{n.f()}return a}(this.props.results.Received),t=T.g("#canvas").attr("width",1050).attr("height",500),a=T.f().force("charge",T.e().strength(-100)).force("center",T.c(525,250)).force("link",T.d().id((function(e){return e.id})).strength((function(e){return e.strength}))),n=T.a().on("start",(function(e){e.fx=e.x,e.fy=e.y})).on("drag",(function(e){a.alphaTarget(.7).restart(),e.fx=T.b.x,e.fy=T.b.y})).on("end",(function(e){T.b.active||a.alphaTarget(0),e.fx=null,e.fy=null})),r=t.append("g").selectAll("circle").data(e.nodes).enter().append("circle").attr("r",10).attr("fill",R).call(n).on("click",(function(t){var a,n=(a=t,e.links.reduce((function(e,t){return t.target.id===a.id?e.push(t.source.id):t.source.id===a.id&&e.push(t.target.id),e}),[a.id]));r.attr("fill",(function(e){return R(e,n)})),l.attr("fill",(function(e){return function(e,t){return Array.isArray(t)&&t.indexOf(e.id)>-1?"green":"black"}(e,n)})),c.attr("stroke",(function(e){return function(e,t){return function(e,t){return t.target.id===e.id||t.source.id===e.id}(e,t)?"green":"#E5E5E5"}(t,e)}))})),l=t.append("g").selectAll("text").data(e.nodes).enter().append("text").text((function(e){return e.id})).attr("font-size",15).attr("dx",15).attr("dy",4),c=t.append("g").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",1).attr("stroke","#E5E5E5");a.nodes(e.nodes).on("tick",(function(){r.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),l.attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})),c.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y}))})),a.force("link").links(e.links)}}},{key:"render",value:function(){return this.state.enabled?r.a.createElement(w.a,{basic:!0},r.a.createElement("svg",{id:"canvas"})):r.a.createElement(w.a,{basic:!0,disabled:!0},r.a.createElement(o.a,{as:"h4"},"Nothing to display."))}}]),a}(n.Component),L=a(484),P=a(482),z=a(476),D=function(e,t){for(var a=0,n=Object.keys(t);a<n.length;a++){var r=n[a];if(r.toLowerCase()===e.toLowerCase())return t[r]}return""},N=function(e,t){for(var a=/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi,n=0,r=Object.keys(t);n<r.length;n++){var l=r[n];if(l.toLowerCase()===e.toLowerCase()){var c=t[l].match(a);return null!==c?c:[]}}return[]},M=function(e){var t={},a=e.match(/[\s(,;[](?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)[\s),;\]]/);null!==a&&a.length>0&&(t.ipv4=a[0].replace(/^[\s(,;[]/,"").replace(/[\s),;\]]$/,""));var n=e.match(/([0-9a-f]|:){1,4}(:([0-9a-f]{0,4})*){1,7}/i);null!==n&&n.length>0&&(t.ipv6=n[0]);var r=e.match(/((?=[a-z0-9-]{1,63}\.)(xn--)?[a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,63}/);return null!==r&&r.length>0&&(t.dns=r[0]),t},B=function(e){var t,a=[],n=Object(O.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,l={},c=(r=r.replace("\n"," ").replace("\t"," ")).indexOf(";");-1!==c&&(l.timestamp=r.substring(c+1,r.length),r=r.substring(0,c));var i=r.indexOf("by ");-1!==i&&(l.target=M(r.substring(i+3,r.length)),r=r.substring(0,i));var o=r.indexOf("from ");-1!==o&&(l.source=M(r.substring(o+5,r.length))),a.push(l)}}catch(s){n.e(s)}finally{n.f()}return a},J=function(e){var t=document.createElement("textarea");t.innerText=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),t.remove()},F=function(e,t){return r.a.createElement(L.a.Item,null,r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Check if this email address has been compromised on IHaveBeenPwned",trigger:r.a.createElement(b.a,{icon:"zoom",circular:!0,onClick:function(){return document.location.href="https://haveibeenpwned.com/"}})})),r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Copy to clipboard",trigger:r.a.createElement(b.a,{icon:"copy",circular:!0,onClick:function(){return J(e)}})})),r.a.createElement(L.a.Content,null,r.a.createElement(L.a.Header,null,e),r.a.createElement(L.a.Description,null,t)))},V=function(e){return void 0!==e?r.a.createElement(L.a,{relaxed:!0,selection:!0},"dns"in e?r.a.createElement(L.a.Item,null,r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Perform a DNS lookup search",trigger:r.a.createElement(b.a,{icon:"at",circular:!0,disabled:!0})})),r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Copy to clipboard",trigger:r.a.createElement(b.a,{icon:"copy",circular:!0,onClick:function(){return J(e.dns)}})})),r.a.createElement(L.a.Header,null,"Domain Name"),e.dns):null,"ipv4"in e?r.a.createElement(L.a.Item,null,r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Perform a DNS reverse lookup",trigger:r.a.createElement(b.a,{icon:"cloud",circular:!0,disabled:!0})})),r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Copy to clipboard",trigger:r.a.createElement(b.a,{icon:"copy",circular:!0,onClick:function(){return J(e.ipv4)}})})),r.a.createElement(L.a.Header,null,"IPv4"),e.ipv4):null,"ipv6"in e?r.a.createElement(L.a.Item,null,r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Perform a DNS reverse lookup",trigger:r.a.createElement(b.a,{icon:"cloud",circular:!0,disabled:!0})})),r.a.createElement(L.a.Content,{floated:"right"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Copy to clipboard",trigger:r.a.createElement(b.a,{icon:"copy",circular:!0,onClick:function(){return J(e.ipv6)}})})),r.a.createElement(L.a.Header,null,"IPv6"),e.ipv6):null):null},Z=function(e){var t,a=(t=e.results,{users:{From:N("From",t),To:N("To",t),Cc:N("Cc",t),"Return-Path":N("Return-Path",t)},contents:{"Message-Id":D("Message-Id",t),Date:D("Date",t),Subject:D("Subject",t),"MIME-Version":D("MIME-Version",t),"Content-Type":D("Content-Type",t),"Content-Language":D("Content-Language",t)},routing:B("Received"in t?t.Received:[])});return r.a.createElement(w.a,{basic:!0},r.a.createElement(b.a,{icon:!0,labelPosition:"right",onClick:x(JSON.stringify(a,null,2),"email-metadata-analyzer-summary.json")},"Download JSON",r.a.createElement(s.a,{name:"download"})),r.a.createElement(o.a,{as:"h2"},r.a.createElement(s.a,{name:"users"}),r.a.createElement(o.a.Content,null,"Stakeholders")),r.a.createElement(o.a,{as:"h4",disabled:0===a.users.From.length&&0===a.users["Return-Path"].length},"Sender"),r.a.createElement(L.a,{relaxed:!0,selection:!0},a.users.From.map((function(e){return F(e,"From")})),a.users["Return-Path"].map((function(e){return F(e,"Return-Path")}))),r.a.createElement(z.a,null),r.a.createElement(o.a,{as:"h4",disabled:0===a.users.To.length&&0===a.users.Cc.length},"Recipient(s)"),r.a.createElement(L.a,{relaxed:!0,selection:!0},a.users.To.map((function(e){return F(e,"To")})),a.users.Cc.map((function(e){return F(e,"Cc")}))),r.a.createElement(z.a,null),r.a.createElement(o.a,{as:"h2",disabled:0===Object.keys(a.contents).length},r.a.createElement(s.a,{name:"file alternate"}),r.a.createElement(o.a.Content,null,"Contents")),r.a.createElement(k.a,{basic:"very",selectable:!0},r.a.createElement(k.a.Body,null,Object.keys(a.contents).map((function(e){return r.a.createElement(k.a.Row,{disabled:""===a.contents[e]},r.a.createElement(k.a.Cell,{width:3},r.a.createElement("b",null,e)),r.a.createElement(k.a.Cell,{width:11},a.contents[e]),r.a.createElement(k.a.Cell,{width:2,textAlign:"center"},r.a.createElement(P.a,{inverted:!0,style:{opacity:.8},content:"Copy to clipboard",trigger:r.a.createElement(b.a,{icon:"copy",circular:!0,disabled:""===a.contents[e],onClick:function(){return J(a.contents[e])}})})))})))),r.a.createElement(z.a,null),r.a.createElement(o.a,{as:"h2",disabled:0===Object.keys(a.contents).length},r.a.createElement(s.a,{name:"globe"}),r.a.createElement(o.a.Content,null,"Routing")),a.routing.length>0?r.a.createElement(k.a,{columns:3},r.a.createElement(k.a.Header,null,r.a.createElement(k.a.HeaderCell,null,"Timestamp"),r.a.createElement(k.a.HeaderCell,null,"Source"),r.a.createElement(k.a.HeaderCell,null,"Target")),r.a.createElement(k.a.Body,null,a.routing.map((function(e){return r.a.createElement(k.a.Row,{key:e},"timestamp"in e?r.a.createElement(k.a.Cell,null,e.timestamp):r.a.createElement(k.a.Cell,null),"source"in e?r.a.createElement(k.a.Cell,null,V(e.source)):r.a.createElement(k.a.Cell,null),"target"in e?r.a.createElement(k.a.Cell,null,V(e.target)):r.a.createElement(k.a.Cell,null))})))):null)},G=function(e){Object(g.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={email:"",results:{},messageHidden:!0,activeIndex:0},e.handleChange=function(t,a){var n=a.name,r=a.value;return e.setState(Object(h.a)({},n,r))},e.handleSubmit=function(){e.setState({results:{},messageHidden:!0,activeIndex:0});var t=A(e.state.email);e.setState({results:t}),e.setState({messageHidden:0!==Object.keys(t).length})},e.handleDismiss=function(){e.setState({messageHidden:!0})},e.handleClear=function(){e.setState({email:"",loading:!1,results:{},messageHidden:!0})},e.handleTabChange=function(t,a){var n=a.activeIndex;return e.setState({activeIndex:n})},e}return Object(E.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(y.a,{style:{textAlign:"center",marginTop:"3em"}},r.a.createElement(y.a.TextArea,{placeholder:"Email contents",name:"email",value:this.state.email,onChange:this.handleChange,rows:15}),r.a.createElement(b.a,{onClick:this.handleSubmit},"Analyse"),r.a.createElement(b.a,{onClick:this.handleClear,color:"orange",disabled:0===this.state.email.length},"Clear")),r.a.createElement(v.a,{warning:!0,hidden:this.state.messageHidden,onDismiss:this.handleDismiss},r.a.createElement(v.a.Header,null,"Could not parse any header..."),r.a.createElement("p",null,"Please enter an other input to parse.")),r.a.createElement(C.a,{activeIndex:this.state.activeIndex,onTabChange:this.handleTabChange,panes:[{menuItem:"Summary",render:function(){return r.a.createElement(C.a.Pane,null,r.a.createElement(Z,{results:e.state.results}))}},{menuItem:"Routing Graph",render:function(){return r.a.createElement(C.a.Pane,null,r.a.createElement(H,{results:e.state.results}))}},{menuItem:"Table",render:function(){return r.a.createElement(C.a.Pane,null,r.a.createElement(j,{results:e.state.results}))}},{menuItem:"JSON",render:function(){return r.a.createElement(C.a.Pane,null,r.a.createElement(I,{results:e.state.results}))}}],hidden:0===Object.keys(this.state.results).length,style:{marginTop:"3em"},defaultActiveIndex:0}))}}]),a}(n.Component),U=a(479),W=function(){return r.a.createElement(U.a,{trigger:r.a.createElement(b.a,{basic:!0,size:"huge",style:{position:"absolute",top:"0",border:"0",left:"0",width:"3.2em",marginLeft:"3em",marginTop:"2em"},icon:"info"})},r.a.createElement(o.a,{icon:"info circle",content:"Info"}),r.a.createElement(U.a.Content,null,r.a.createElement(i.a,{text:!0,textAlign:"justified"},r.a.createElement(o.a,{size:"medium"},"What is this website?"),r.a.createElement("p",null,"Emails are sent with a few extra information other than their plain contents. They can be useful to assess a message's origin, its path from an email server to an other, the protocols used, its content nature, etc."),r.a.createElement("p",null,"These metadata are rarely displayed by email clients and are not easy for a human to read. This website purpose is to help oneself to extract meaningful information from them."),r.a.createElement(o.a,{size:"medium"},"How can I use it?"),r.a.createElement("p",null,"Just copy/paste an email metadata string in the form text area and click on  ",r.a.createElement("i",null,"Analyse"),"."),r.a.createElement("p",null,"Currently, four views are available:"),r.a.createElement(L.a,{bulleted:!0},r.a.createElement(L.a.Item,null,r.a.createElement("b",null,"Summary")," displays the most common parsed headers"),r.a.createElement(L.a.Item,null,r.a.createElement("b",null,"Graph")," displays a network chart of the message trip through email servers"),r.a.createElement(L.a.Item,null,r.a.createElement("b",null,"Table")," and ",r.a.createElement("b",null,"JSON")," dispays the raw headers under CSV and JSON formats.")),r.a.createElement(o.a,{size:"medium"},"I don't feel comfortable with entering personal email data on a website, is it safe?"),r.a.createElement("p",null,"This is a legitimate concern!"),r.a.createElement("p",null,"This website does not perform any call to a backend that would process the results. Everything is computed inside your browser."),r.a.createElement("p",null,"You can read the code on GitHub if you want to check it: ",r.a.createElement("a",{href:"https://github.com/juliendoutre/email-analyser"},"https://github.com/juliendoutre/email-analyser")),r.a.createElement("p",null,"You can even deploy the website from the code on your machine (just follow the ",r.a.createElement("a",{href:"https://github.com/juliendoutre/email-analyser/blob/master/README.md"},"README")," instructions to get started)."),r.a.createElement(o.a,{size:"medium"},"How do I find an email headers?"),r.a.createElement("p",null,"They are usually avaible in an email client message ",r.a.createElement("i",null,"Details")," panel."),r.a.createElement("p",null,"The following page can help you to get them from various clients : ",r.a.createElement("a",{href:"https://support.google.com/mail/answer/29436?hl=en"},"https://support.google.com/mail/answer/29436?hl=en"),"."))))},_=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(d,null),r.a.createElement(W,null),r.a.createElement(i.a,{style:{paddingTop:"3em",paddingBottom:"3em"},textAlign:"left"},r.a.createElement(m,null),r.a.createElement(G,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[282,1,2]]]);
//# sourceMappingURL=main.d584add9.chunk.js.map